# –ü—Ä–∏–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤ ProductDB

## üìÑ prices_example.json

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ü–µ–Ω –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

**–§–æ—Ä–º–∞—Ç:**
```json
[
    {
        "component_id": 1,           // ID –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–µ–≥–æ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã components
        "price": 15.50,              // –¶–µ–Ω–∞ –∑–∞ –µ–¥–∏–Ω–∏—Ü—É
        "currency": "RUB",           // –í–∞–ª—é—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é RUB)
        "valid_from": "2025-01-01",  // –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ü–µ–Ω—ã (YYYY-MM-DD)
        "notes": "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ"        // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ
    }
]
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from database import Database
from export_ppm import import_prices_from_json

with Database() as db:
    count, errors = import_prices_from_json('examples/prices_example.json', db)
    print(f"–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ {count} —Ü–µ–Ω")
    if errors:
        print(f"–û—à–∏–±–∫–∏: {errors}")
```

---

## üìä prices_example.xlsx

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ —Ü–µ–Ω –≤ —Ñ–æ—Ä–º–∞—Ç–µ Excel.

**–§–æ—Ä–º–∞—Ç —Ç–∞–±–ª–∏—Ü—ã:**

| ID –∫–æ–º–ø–ª–µ–∫—Ç—É—é—â–µ–≥–æ | –¶–µ–Ω–∞ | –í–∞–ª—é—Ç–∞ | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
|-------------------|------|--------|---------------------|------------|
| 1 | 15.50 | RUB | 2025-01-01 | –ë–µ—Ç–æ–Ω M20 |
| 2 | 18.00 | RUB | 2025-01-01 | –ë–µ—Ç–æ–Ω M25 |
| ... | ... | ... | ... | ... |

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from database import Database
from export_ppm import import_prices_from_excel

with Database() as db:
    count, errors = import_prices_from_excel('examples/prices_example.xlsx', db)
    print(f"–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ {count} —Ü–µ–Ω")
```

---

## üìã PPM_template.xlsx

–®–∞–±–ª–æ–Ω –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –ü–ü–ú –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω –≤—Ä—É—á–Ω—É—é –≤ Excel).

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –Ø—á–µ–π–∫–∞ B2: –ú–µ—Å—è—Ü
- –Ø—á–µ–π–∫–∞ D2: –ì–æ–¥
- –Ø—á–µ–π–∫–∞ F2: –í–µ—Ä—Å–∏—è
- –°—Ç—Ä–æ–∫–∞ 5 –∏ –¥–∞–ª–µ–µ: –¢–∞–±–ª–∏—Ü–∞ —Å –ø–æ–∑–∏—Ü–∏—è–º–∏

**–§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (PPM_config.json):**
```json
{
    "month_cell": "B2",
    "year_cell": "D2",
    "version_cell": "F2",
    "items_start_row": 5,
    "columns": {
        "number": "A",
        "client": "B",
        "drawing": "C",
        "variant": "D",
        "quantity_was": "E",
        "quantity_now": "F",
        "deadline_was": "G",
        "deadline_now": "H",
        "notes": "I"
    }
}
```

---

## üí° –°–æ–≤–µ—Ç—ã

1. **JSON —Ñ–æ—Ä–º–∞—Ç** —É–¥–æ–±–µ–Ω –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω–∞–º–∏
2. **Excel —Ñ–æ—Ä–º–∞—Ç** —É–¥–æ–±–µ–Ω –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `component_id` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –î–∞—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD
5. –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –∏–∑ Excel –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
